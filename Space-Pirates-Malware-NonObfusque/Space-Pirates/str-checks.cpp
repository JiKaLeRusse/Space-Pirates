#include "stdafx.h"
#include "str-checks.h"

char hello[16] = { 'V' ^42, 'o' ^69, 'u' ^42, 's' ^69, ' ' ^42, 'a' ^69, 'v' ^42, 'e' ^69, 'z' ^42, ' ' ^69, 'g' ^42, 'a' ^69, 'g' ^42, 'n' ^69, 'e' ^42, '\x00' ^69};

bool char_in_list(char entry, char *list){
	int i = 0;
	int n=strlen(list);
	while (i < n && entry != list[i]){
		i++;
	}
	return (i != n);
}

bool valid_entry(char *entry){
	char valid_char[23]="abcdefABCDEF0123456789"; // à rendre constant
	int n=strlen(entry);
	int i = 0;
	if(n <= 32){
		while (i < n && char_in_list(entry[i], valid_char)){
			i++;
		}
	}
	return (n <= 32 && i == n);
}

void check_key(char *entry, char* key) {
	type_print ouioui = get_ouioui();
	if (!entry){
		return;
	}
	char* vre = traitement(entry);
	int won = 0;
	if (memcmp(entry, key, 25) == 0){
		won = 1 && memcmp(entry, key, 25);
	} else {
		won = 0;
	}

	if (won) {
		char *s;
		for (int i = 0 ; i < 16 ; ++i){ 
			if (i%2==0){s[i] = hello[i] ^42;}
			else {s[i] = hello[i] ^69;}
		}
		ouioui(s);
		for (int i = 0 ; i < 16 ; ++i){
			if (i%2==0){s[i] = s[i] ^42;}
			else {s[i] = s[i] ^69;}
		}
	} else {
		ouioui(entry);
	}
}